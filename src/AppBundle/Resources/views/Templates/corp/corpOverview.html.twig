<div ng-controller="corpOverviewController" class="row">
    <div class="col-xs-12 well" ng-show="!selected_corp" ng-cloak>
        <h5 class="text-center">Select a Corporation</h5>
    </div>
    <div class="col-xs-12 well" ng-show="selected_corp" ng-cloak>
        <div class="row">
            <div class="col-xs-12" ng-cloak>
                <div class="row">
                    <div class="summary-stats col-xs-11" ng-cloak>
                        <div class="row">
                            <div class="col-xs-3">
                                <b>Balance</b>:&nbsp;&nbsp;&nbsp; {{ '{{ totalBalance | currency:"ISK"}}' }}<br>
                                <b>Daily Change</b>:&nbsp;&nbsp;&nbsp;<i ng-class="{ 'fa fa-chevron-up text-success': percentChangeBalance.percent > 0, 'fa fa-chevron-down text-danger': percentChangeBalance.percent < 0 }"></i><br>
                                {{ '{{ percentChangeBalance.percent | number : 2 }}% ({{ percentChangeBalance.diff | currency:"ISK" }})' }}
                                <br>
                                <span class="small muted" ng-show="updated_at">
                                    <b>Updated At:</b> {{ '{{ updated_at | date }} {{ updated_at | date:"shortTime" }}' }} <i class="fa" ng-class="{ 'fa-check text-success': update_succeeded , 'fa-times text-danger': !update_succeeded}"></i><br>
                                    <b>Next Update:</b> {{ '{{ next_update | date }} {{ next_update | date:"shortTime" }}' }}<br>
                                </span>
                            </div>
                            <div class="graphs col-xs-9" ng-hide="not_enough_data"></div>
                            <div class="col-xs-9" ng-show="not_enough_data"><h4 class="text-center">Not Enough Data</h4></div>
                        </div>
                    </div>
                    <div class="col-xs-1 viewing-details" >
                        <span class="pull-right small"><b>Viewing:</b> {{ ' {{ current_date }}' }}</span>
                        <br>
                        <div class="btn-group-sm pull-right controls">
                            <button  class="btn btn-sm" type="button" ng-click="back()" ng-disabled="!selected_account"><i class="fa fa-chevron-left"></i></button>
                            <button class="btn btn-sm" type="button" ng-click="forward()" ng-disabled="!selected_account"><i class="fa fa-chevron-right"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br>

        <div class="row">
            <div class="col-xs-3">
                <ul class="list-unstyled list-group wallet-divisions">
                    <li ng-repeat="acc in accounts" ng-class="{ 'list-group-item active': selected_account.id == acc.id, 'list-group-item': selected_account.id != acc.id}" ng-click="selectAccount(acc)">
                        <p>
                            <b>{{ '{{ acc.name }}' }}</b>: {{ '{{ acc.current_balance | currency:"ISK" }}' }}
                            <loading-spinner class="spinner-inline" style="color: #c7ddef" ng-show="loading && selected_account.id == acc.id"></loading-spinner>
                        </p>
                        <p ng-show="selected_account.id == acc.id">
                            <b>Division Change:</b>&nbsp;&nbsp;&nbsp; <i ng-class="{ 'fa fa-chevron-up text-success': findGross() > 0, 'fa fa-chevron-down text-danger': findGross() < 0 }"></i>
                            {{ '{{ findGross() | currency:"ISK" }}' }}
                        </p>
                    </li>
                </ul>
            </div>
            <div ng-show="page == 'buy'">
                <h5 class="text-danger">Buy Orders - <span class="small">Total: {{ '{{  sumOrders(buy_orders) | currency:"ISK" }}' }}</span>
                    <button class="btn-link pull-right" ng-click="switchPage('sell')">Sell Orders</button>
                </h5>
            </div>

            <div ng-show="page == 'sell'">
                <h5 class="text-success">Sell Orders - <span class="small">Total: {{ '{{  sumOrders(sell_orders) | currency:"ISK" }}' }}</span>
                    <button class="btn-link pull-right" ng-click="switchPage('buy')">Buy Orders</button>
                </h5>
            </div>
            <div class="col-xs-9" ng-show="selected_account && page == 'buy'">
                <div class="table-responsive">
                    <table class="table table-striped data-table table-condensed table-hover">
                        <thead>
                        <th>Item</th>
                        <th>Volume</th>
                        <th>Price Per</th>
                        <th>Gross</th>
                        <th>Seller</th>
                        <th>Client</th>
                        </thead>
                        <tbody>
                        <tr ng-show="buy_orders.length > 0 " ng-repeat="b in buy_orders | filter:orderBy:'price * quantity'">
                            <td>
                                <div class="row">
                                    <div class="col-xs-3">
                                        <eve-image image-type="'Type'" object-id="b.item_id" img-width="32"></eve-image>
                                    </div>
                                    <div class="col-xs-9">
                                        {{ '{{ b.item_name }}' }}
                                    </div>
                                </div>
                            </td>
                            <td>{{ '{{ b.quantity }}' }}</td>
                            <td>{{ '{{ b.price | currency:"ISK" }}' }}</td>
                            <td>{{ '{{ b.price * b.quantity | currency:"ISK"}}' }}</td>
                            <td width="35">
                                <eve-image image-type="'Character'" object-id="b.character_id" img-width="256"></eve-image> {{ '{{ b.character_name }}' }}
                            </td>
                            <td width="35">
                                <eve-image image-type="'Character'" object-id="b.client_id" img-width="256"></eve-image> {{ '{{ b.client_name }}' }}
                            </td>
                        </tr>
                        <tr ng-show="buy_orders.length == 0">
                            <td colspan="6" class="text-center text-danger">
                                No Buy Orders Found.
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <div class="col-xs-9" ng-show="selected_account && page == 'sell'">
                    <table class="table table-striped data-table table-condensed table-hover">
                        <thead>
                        <th>Item</th>
                        <th>Volume</th>
                        <th>Price Per</th>
                        <th>Gross</th>
                        <th>Seller</th>
                        <th>Client</th>
                        </thead>
                        <tbody>

                        <tr ng-show="sell_orders.length> 0 " ng-repeat="s in sell_orders">
                            <td>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <eve-image image-type="'Type'" object-id="s.item_id" img-width="32"></eve-image>
                                    </div>
                                    <div class="col-xs-7">
                                        {{ '{{ s.item_name }}' }}
                                    </div>
                                </div>
                            </td>
                            <td>{{ '{{ s.quantity }}' }}</td>
                            <td>{{ '{{ s.price | currency:"ISK" }}' }}</td>
                            <td>{{ '{{ s.price * s.quantity | currency:"ISK"}}' }}</td>
                            <td width="35">
                                <eve-image image-type="'Character'" object-id="s.character_id" img-width="256"></eve-image> {{ '{{ s.character_name }}' }}
                            </td>
                            <td width="35">
                                <eve-image image-type="'Character'" object-id="s.client_id" img-width="256"></eve-image> {{ '{{ s.client_name }}' }}
                            </td>
                        </tr>
                        <tr ng-show="sell_orders.length == 0">
                            <td colspan="6" class="text-center text-danger">
                                No Sell Orders Found.
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
